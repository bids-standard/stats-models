
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Representing multi-stage neuroimaging models &#8212; BIDS Stats Models Specification</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=62ba249389abaaa9ffc34bf36a076bdc1d65ee18" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/autodoc_pydantic.css" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=f31d14ad54b65d19161ba51d4ffff3a77ae00456"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/js/jsoneditor.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Advanced usage" href="walkthrough-2.html" />
    <link rel="prev" title="Walkthrough" href="walkthrough-intro.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/bids_black.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">BIDS Stats Models Specification</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  User Guide
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="motivation.html">
   Motivation
  </a>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="walkthrough-intro.html">
   Walkthrough
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Representing multi-stage neuroimaging models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="walkthrough-2.html">
     Advanced usage
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="integration.html">
   Integration with other standards
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="legacy.html">
   Legacy specification
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="json_101.html">
   JSON 101
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Specification
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="reference.html">
   BIDS Stats Models Object Reference
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="_autosummary/bsmschema.models.BIDSStatsModel.html">
     bsmschema.models.BIDSStatsModel
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_autosummary/bsmschema.models.Node.html">
     bsmschema.models.Node
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_autosummary/bsmschema.models.Transformations.html">
     bsmschema.models.Transformations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_autosummary/bsmschema.models.Model.html">
     bsmschema.models.Model
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_autosummary/bsmschema.models.HRF.html">
     bsmschema.models.HRF
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_autosummary/bsmschema.models.Options.html">
     bsmschema.models.Options
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_autosummary/bsmschema.models.Contrast.html">
     bsmschema.models.Contrast
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_autosummary/bsmschema.models.DummyContrasts.html">
     bsmschema.models.DummyContrasts
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_autosummary/bsmschema.models.Edge.html">
     bsmschema.models.Edge
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="validator.html">
   BIDS Stats Model Validator
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Examples and resources
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="model-zoo.html">
   Model Zoo
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="default_model.html">
   Creating a default model
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/bids-standard/stats-models/main?urlpath=tree/specification/walkthrough-1.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/bids-standard/stats-models"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/bids-standard/stats-models/issues/new?title=Issue%20on%20page%20%2Fwalkthrough-1.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/walkthrough-1.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download notebook file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-code"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        <a href="_sources/walkthrough-1.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.md</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-simple-example">
   A simple example
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#run-level-model">
     Run-level Model
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#how-to-group-analysis-inputs">
       How to
       <em>
        group
       </em>
       analysis inputs?
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#subject-level-node">
     Subject level Node
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#from-run-outputs-to-subject-inputs">
       From Run Outputs to Subject Inputs
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#subject-model">
       Subject Model
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dataset-level-node">
     Dataset level Node
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#ready-to-run">
   Ready to run 🚀
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#next-up">
   Next up
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Representing multi-stage neuroimaging models</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-simple-example">
   A simple example
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#run-level-model">
     Run-level Model
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#how-to-group-analysis-inputs">
       How to
       <em>
        group
       </em>
       analysis inputs?
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#subject-level-node">
     Subject level Node
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#from-run-outputs-to-subject-inputs">
       From Run Outputs to Subject Inputs
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#subject-model">
       Subject Model
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dataset-level-node">
     Dataset level Node
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#ready-to-run">
   Ready to run 🚀
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#next-up">
   Next up
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="representing-multi-stage-neuroimaging-models">
<h1>Representing multi-stage neuroimaging models<a class="headerlink" href="#representing-multi-stage-neuroimaging-models" title="Permalink to this headline">#</a></h1>
<p>The statistical analysis of neuroimaging data typically occurs across distinct
stages of analysis, with parameter estimates from lower levels of analysis
propagating to higher levels for subsequent analysis.</p>
<p>For example, in fMRI it is common to first fit a design matrix to run-level time
series followed by a fixed-effects model to combine estimates at the
subject-level. Finally, a dataset-level (or “group level”) random-effects
one-sample t-test can be performed to estimate population level effects. At each
level of the analysis, we need to know which image inputs correspond to which
design matrix, and more how to keep track of and combine outputs from the
previous level at the current level of analysis.</p>
<p><em>BIDS Stats Models</em> proposes a general machine-readable document to describe
multi-stage neuroimaging analyses in a precise, yet flexible manner. We
accomplish this by defining a <em>graph</em> composed of <strong>Nodes</strong> representing each
level of the analysis and <strong>Edges</strong> which define the flow of data from one Node
to another. Within each <a class="reference internal" href="_autosummary/bsmschema.models.Node.html#bsmschema.models.Node" title="bsmschema.models.Node"><code class="xref py py-class docutils literal notranslate"><span class="pre">Node</span></code></a> we specify a
<a class="reference internal" href="_autosummary/bsmschema.models.Model.html#bsmschema.models.Model" title="bsmschema.models.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a> to estimate, and at least one
<a class="reference internal" href="_autosummary/bsmschema.models.Contrast.html#bsmschema.models.Contrast" title="bsmschema.models.Contrast"><code class="xref py py-class docutils literal notranslate"><span class="pre">Contrast</span></code></a> to define the computed outputs of each
<code class="docutils literal notranslate"><span class="pre">Node</span></code>. Within each node we also specify how to group the incoming inputs into
analysis units using the <a class="reference internal" href="_autosummary/bsmschema.models.Node.html#bsmschema.models.Node.GroupBy" title="bsmschema.models.Node.GroupBy"><code class="xref py py-attr docutils literal notranslate"><span class="pre">GroupBy</span></code></a> directive.</p>
<section id="a-simple-example">
<h2>A simple example<a class="headerlink" href="#a-simple-example" title="Permalink to this headline">#</a></h2>
<p>In a <a class="reference external" href="https://openneuro.org/datasets/ds000101/versions/00004">Simon task</a>,
participants were scanned for 2 runs and asked to indicate whether a diamond
that was presented to the left or right of a central fixation cross was green or
red. There were two conditions: color-spatial <em>congruent</em> and <em>incongruent</em>
trials.</p>
<p>A basic analysis of this task is to determine which regions showed <em>greater
activity for incongruent versus congruent trials</em>, across all participants.</p>
<p>We can perform this analysis by first estimating a <strong>run-level</strong> timeseries
model for “Incongruent” and “Congruent” trials–separately for each individual
run. We then compute a contrast comparing <em>Incongruent &gt; Congruent</em> (IvC)
trials.</p>
<p>Next, we pass the resulting statistical maps for the contrast to a
<strong>subject-level</strong> estimator, which computes the average <em>IvC</em> effect for each
subject separately.</p>
<p>Finally, we pass the resulting estimates to a
<strong>dataset-level</strong> estimator, which conduts a one-sample t-test across all of the
subject estimates for the <em>IvC</em> contrast.</p>
<p>Let’s visualize this model for 3 participants:</p>
<p><img alt="flow" src="_images/flow_model.png" /></p>
<p>We can formally represent this analysis as <strong>BIDS Stats Model</strong>:</p>
<div class="highlight-JSON notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="nt">&quot;Name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Simon IvC&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">  </span><span class="nt">&quot;BIDSModelVersion&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">  </span><span class="nt">&quot;Input&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;subject&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;01&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;02&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;03&quot;</span><span class="p">],</span><span class="w"> </span><span class="nt">&quot;task&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;simon&quot;</span><span class="p">},</span><span class="w"></span>
<span class="w">  </span><span class="nt">&quot;Nodes&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="nt">&quot;Level&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Run&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="nt">&quot;Name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;run_level&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="nt">&quot;GroupBy&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;run&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;subject&quot;</span><span class="p">],</span><span class="w"></span>
<span class="w">      </span><span class="nt">&quot;Model&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;X&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;incongruent&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;congruent&quot;</span><span class="p">],</span><span class="w"> </span><span class="nt">&quot;Type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;glm&quot;</span><span class="p">},</span><span class="w"></span>
<span class="w">      </span><span class="nt">&quot;Contrasts&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">          </span><span class="nt">&quot;Name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;IvC&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">          </span><span class="nt">&quot;ConditionList&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;incongruent&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;congruent&quot;</span><span class="p">],</span><span class="w"></span>
<span class="w">          </span><span class="nt">&quot;Weights&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">],</span><span class="w"></span>
<span class="w">          </span><span class="nt">&quot;Test&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;t&quot;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">      </span><span class="p">]</span><span class="w"></span>
<span class="w">    </span><span class="p">},</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="nt">&quot;Level&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Subject&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="nt">&quot;Name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;subject_level&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="nt">&quot;GroupBy&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;subject&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;contrast&quot;</span><span class="p">],</span><span class="w"></span>
<span class="w">      </span><span class="nt">&quot;Model&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;X&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="nt">&quot;Type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;meta&quot;</span><span class="p">},</span><span class="w"></span>
<span class="w">      </span><span class="nt">&quot;DummyContrasts&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;Test&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;t&quot;</span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">},</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="nt">&quot;Level&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Dataset&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="nt">&quot;Name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;one-sample_dataset&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="nt">&quot;GroupBy&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;contrast&quot;</span><span class="p">],</span><span class="w"></span>
<span class="w">      </span><span class="nt">&quot;Model&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;X&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="nt">&quot;Type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;glm&quot;</span><span class="p">},</span><span class="w"></span>
<span class="w">      </span><span class="nt">&quot;DummyContrasts&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;Test&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;t&quot;</span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">  </span><span class="p">]</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p>BIDS Stats Models <em>must</em> have a <a class="reference internal" href="_autosummary/bsmschema.models.BIDSStatsModel.html#bsmschema.models.BIDSStatsModel.Name" title="bsmschema.models.BIDSStatsModel.Name"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Name</span></code></a> and <a class="reference internal" href="_autosummary/bsmschema.models.BIDSStatsModel.html#bsmschema.models.BIDSStatsModel.BIDSModelVersion" title="bsmschema.models.BIDSStatsModel.BIDSModelVersion"><code class="xref py py-attr docutils literal notranslate"><span class="pre">BIDSModelVersion</span></code></a> defined, and optionally can restrict input images with <a class="reference internal" href="_autosummary/bsmschema.models.BIDSStatsModel.html#bsmschema.models.BIDSStatsModel.Input" title="bsmschema.models.BIDSStatsModel.Input"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Input</span></code></a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For this example, we have limited the model to three subjects using the <code class="docutils literal notranslate"><span class="pre">Input</span></code> key.</p>
</div>
<p><em>BSM</em> defines this multi-stage analysis as a Graph, with each level of analysis
defined as a separate <code class="docutils literal notranslate"><span class="pre">Node</span></code> object. Let’s step through each <code class="docutils literal notranslate"><span class="pre">Node</span></code> separately.</p>
<section id="run-level-model">
<h3>Run-level Model<a class="headerlink" href="#run-level-model" title="Permalink to this headline">#</a></h3>
<p>First, we define a <code class="docutils literal notranslate"><span class="pre">Node</span></code> for the run level analysis.</p>
<div class="highlight-JSON notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="nt">&quot;Level&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Run&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="nt">&quot;Name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;run_level&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="nt">&quot;GroupBy&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;run&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;subject&quot;</span><span class="p">],</span><span class="w"></span>
<span class="w">      </span><span class="nt">&quot;Model&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;X&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;incongruent&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;congruent&quot;</span><span class="p">],</span><span class="w"> </span><span class="nt">&quot;Type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;glm&quot;</span><span class="p">},</span><span class="w"></span>
<span class="w">      </span><span class="nt">&quot;Contrasts&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">          </span><span class="nt">&quot;Name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;IvC&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">          </span><span class="nt">&quot;ConditionList&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;incongruent&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;congruent&quot;</span><span class="p">],</span><span class="w"></span>
<span class="w">          </span><span class="nt">&quot;Weights&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">],</span><span class="w"></span>
<span class="w">          </span><span class="nt">&quot;Test&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;t&quot;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">      </span><span class="p">]</span><span class="w"></span>
<span class="w">    </span><span class="p">},</span><span class="w"></span>
</pre></div>
</div>
<p>Note that the <a class="reference internal" href="_autosummary/bsmschema.models.Node.html#bsmschema.models.Node.Level" title="bsmschema.models.Node.Level"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Level</span></code></a> key is necessary for
determining which input images are available to the estimator. At the <code class="docutils literal notranslate"><span class="pre">Run</span></code>
level, there are many sources of possible variables, most notably <code class="docutils literal notranslate"><span class="pre">_events.tsv</span></code>
files which define the timing of task-related events.</p>
<p>Next we define a <a class="reference internal" href="_autosummary/bsmschema.models.Model.html#bsmschema.models.Model" title="bsmschema.models.Model"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Model</span></code></a> for this node.</p>
<div class="highlight-JSON notranslate"><div class="highlight"><pre><span></span><span class="w">      </span><span class="nt">&quot;Model&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;X&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;incongruent&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;congruent&quot;</span><span class="p">],</span><span class="w"> </span><span class="nt">&quot;Type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;glm&quot;</span><span class="p">},</span><span class="w"></span>
</pre></div>
</div>
<p>The <a class="reference internal" href="_autosummary/bsmschema.models.Model.html#bsmschema.models.Model.X" title="bsmschema.models.Model.X"><code class="xref py py-attr docutils literal notranslate"><span class="pre">X</span></code></a> parameter defines the variables in the design matrix. Here, we are modeling the <code class="docutils literal notranslate"><span class="pre">incongruent</span></code> and <code class="docutils literal notranslate"><span class="pre">congruent</span></code> trial types, in addition to an intercept (idenitified by the special key: <code class="docutils literal notranslate"><span class="pre">1</span></code>; see: _).</p>
<p>Next, we specify an <em>Incongruent-Congruent (IvC)</em> contrast using the <a class="reference internal" href="_autosummary/bsmschema.models.Contrast.html#bsmschema.models.Contrast" title="bsmschema.models.Contrast"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Contrast</span></code></a> key:</p>
<div class="highlight-JSON notranslate"><div class="highlight"><pre><span></span><span class="w">      </span><span class="nt">&quot;Contrasts&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">          </span><span class="nt">&quot;Name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;IvC&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">          </span><span class="nt">&quot;ConditionList&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;incongruent&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;congruent&quot;</span><span class="p">],</span><span class="w"></span>
<span class="w">          </span><span class="nt">&quot;Weights&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">],</span><span class="w"></span>
<span class="w">          </span><span class="nt">&quot;Test&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;t&quot;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">      </span><span class="p">]</span><span class="w"></span>
</pre></div>
</div>
<p>If you have used other fMRI modeling tools this should be familar. We have
specified a t-test contrast with the weights <code class="docutils literal notranslate"><span class="pre">[1,</span> <span class="pre">-1]</span></code> for the conditions:
<code class="docutils literal notranslate"><span class="pre">[&quot;incongruent&quot;,</span> <span class="pre">&quot;congruent&quot;]</span></code> and given this contrast the name <code class="docutils literal notranslate"><span class="pre">IvC</span></code>.</p>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p><code class="docutils literal notranslate"><span class="pre">Contrasts</span></code> <strong>define the outputs</strong> that will be available to the next <code class="docutils literal notranslate"><span class="pre">Node</span></code>.</p>
<p>Since we only modeled a single contrast (<code class="docutils literal notranslate"><span class="pre">IvC</span></code>), the next <code class="docutils literal notranslate"><span class="pre">Node</span></code> will not have access to estimates for main effects for the <code class="docutils literal notranslate"><span class="pre">congruent</span></code> or <code class="docutils literal notranslate"><span class="pre">incongruent</span></code> conditions, unless we explicitly define a <code class="docutils literal notranslate"><span class="pre">Contrast</span></code> for each.</p>
</div>
<section id="how-to-group-analysis-inputs">
<h4>How to <em>group</em> analysis inputs?<a class="headerlink" href="#how-to-group-analysis-inputs" title="Permalink to this headline">#</a></h4>
<p>An underappreciated factor in multi-stage models is the grouping of image inputs
into analysis units. For example, here we want to estimate a timeseries model
for each <code class="docutils literal notranslate"><span class="pre">Run</span></code> separately, rather that concatenating all runs for each subject
into one large model.</p>
<p>We must explicitly define this grouping structure using the
<a class="reference internal" href="_autosummary/bsmschema.models.Node.html#bsmschema.models.Node.GroupBy" title="bsmschema.models.Node.GroupBy"><code class="xref py py-attr docutils literal notranslate"><span class="pre">GroupBy</span></code></a> key for every node. To fit a separate
time series model for each individual run image, we specify:</p>
<div class="highlight-JSON notranslate"><div class="highlight"><pre><span></span><span class="w">      </span><span class="nt">&quot;GroupBy&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;run&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;subject&quot;</span><span class="p">],</span><span class="w"></span>
</pre></div>
</div>
<p>Here, <code class="docutils literal notranslate"><span class="pre">GroupBy</span></code> states that for every unique combination of <code class="docutils literal notranslate"><span class="pre">run</span></code> and <code class="docutils literal notranslate"><span class="pre">subject</span></code>,
we will fit a separate model. This results in a single input image per model.</p>
<p>If you are familar with tabular data such as R <code class="docutils literal notranslate"><span class="pre">DataFrames</span></code>, or <code class="docutils literal notranslate"><span class="pre">pandas</span></code>, the
<code class="docutils literal notranslate"><span class="pre">GroupBy</span></code> operation should be familar. For instance, given three subjects with
two runs each, we can define 6 rows in a table (3x2):</p>
<div class="cell tag_remove_input docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><style type="text/css">
</style>
<table id="T_9dc90">
  <thead>
    <tr>
      <th id="T_9dc90_level0_col0" class="col_heading level0 col0" >subject</th>
      <th id="T_9dc90_level0_col1" class="col_heading level0 col1" >run</th>
      <th id="T_9dc90_level0_col2" class="col_heading level0 col2" >image</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td id="T_9dc90_row0_col0" class="data row0 col0" >01</td>
      <td id="T_9dc90_row0_col1" class="data row0 col1" >1</td>
      <td id="T_9dc90_row0_col2" class="data row0 col2" >sub-01_task-simon_run-1_bold.nii.gz</td>
    </tr>
    <tr>
      <td id="T_9dc90_row1_col0" class="data row1 col0" >01</td>
      <td id="T_9dc90_row1_col1" class="data row1 col1" >2</td>
      <td id="T_9dc90_row1_col2" class="data row1 col2" >sub-01_task-simon_run-2_bold.nii.gz</td>
    </tr>
    <tr>
      <td id="T_9dc90_row2_col0" class="data row2 col0" >02</td>
      <td id="T_9dc90_row2_col1" class="data row2 col1" >1</td>
      <td id="T_9dc90_row2_col2" class="data row2 col2" >sub-02_task-simon_run-1_bold.nii.gz</td>
    </tr>
    <tr>
      <td id="T_9dc90_row3_col0" class="data row3 col0" >02</td>
      <td id="T_9dc90_row3_col1" class="data row3 col1" >2</td>
      <td id="T_9dc90_row3_col2" class="data row3 col2" >sub-02_task-simon_run-2_bold.nii.gz</td>
    </tr>
    <tr>
      <td id="T_9dc90_row4_col0" class="data row4 col0" >03</td>
      <td id="T_9dc90_row4_col1" class="data row4 col1" >1</td>
      <td id="T_9dc90_row4_col2" class="data row4 col2" >sub-03_task-simon_run-1_bold.nii.gz</td>
    </tr>
    <tr>
      <td id="T_9dc90_row5_col0" class="data row5 col0" >03</td>
      <td id="T_9dc90_row5_col1" class="data row5 col1" >2</td>
      <td id="T_9dc90_row5_col2" class="data row5 col2" >sub-03_task-simon_run-2_bold.nii.gz</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>If we <code class="docutils literal notranslate"><span class="pre">GroupBy</span></code> <em>subject</em>, there would be three groups of images–one for each subject:</p>
<div class="cell tag_remove_input docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><style type="text/css">
</style>
<table id="T_cca7c">
  <thead>
    <tr>
      <th id="T_cca7c_level0_col0" class="col_heading level0 col0" >subject</th>
      <th id="T_cca7c_level0_col1" class="col_heading level0 col1" >run</th>
      <th id="T_cca7c_level0_col2" class="col_heading level0 col2" >image</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td id="T_cca7c_row0_col0" class="data row0 col0" >01</td>
      <td id="T_cca7c_row0_col1" class="data row0 col1" >1</td>
      <td id="T_cca7c_row0_col2" class="data row0 col2" >sub-01_task-simon_run-1_bold.nii.gz</td>
    </tr>
    <tr>
      <td id="T_cca7c_row1_col0" class="data row1 col0" >01</td>
      <td id="T_cca7c_row1_col1" class="data row1 col1" >2</td>
      <td id="T_cca7c_row1_col2" class="data row1 col2" >sub-01_task-simon_run-2_bold.nii.gz</td>
    </tr>
  </tbody>
</table>
</div><div class="output text_html"><style type="text/css">
</style>
<table id="T_44604">
  <thead>
    <tr>
      <th id="T_44604_level0_col0" class="col_heading level0 col0" >subject</th>
      <th id="T_44604_level0_col1" class="col_heading level0 col1" >run</th>
      <th id="T_44604_level0_col2" class="col_heading level0 col2" >image</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td id="T_44604_row0_col0" class="data row0 col0" >02</td>
      <td id="T_44604_row0_col1" class="data row0 col1" >1</td>
      <td id="T_44604_row0_col2" class="data row0 col2" >sub-02_task-simon_run-1_bold.nii.gz</td>
    </tr>
    <tr>
      <td id="T_44604_row1_col0" class="data row1 col0" >02</td>
      <td id="T_44604_row1_col1" class="data row1 col1" >2</td>
      <td id="T_44604_row1_col2" class="data row1 col2" >sub-02_task-simon_run-2_bold.nii.gz</td>
    </tr>
  </tbody>
</table>
</div><div class="output text_html"><style type="text/css">
</style>
<table id="T_e729a">
  <thead>
    <tr>
      <th id="T_e729a_level0_col0" class="col_heading level0 col0" >subject</th>
      <th id="T_e729a_level0_col1" class="col_heading level0 col1" >run</th>
      <th id="T_e729a_level0_col2" class="col_heading level0 col2" >image</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td id="T_e729a_row0_col0" class="data row0 col0" >03</td>
      <td id="T_e729a_row0_col1" class="data row0 col1" >1</td>
      <td id="T_e729a_row0_col2" class="data row0 col2" >sub-03_task-simon_run-1_bold.nii.gz</td>
    </tr>
    <tr>
      <td id="T_e729a_row1_col0" class="data row1 col0" >03</td>
      <td id="T_e729a_row1_col1" class="data row1 col1" >2</td>
      <td id="T_e729a_row1_col2" class="data row1 col2" >sub-03_task-simon_run-2_bold.nii.gz</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>If we <code class="docutils literal notranslate"><span class="pre">GroupBy</span></code> <em>run</em>, all images with the same <em>run</em> ID would be grouped together, resulting in two groups, one for each distinct group ID:</p>
<div class="cell tag_remove_input docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><style type="text/css">
</style>
<table id="T_c08af">
  <thead>
    <tr>
      <th id="T_c08af_level0_col0" class="col_heading level0 col0" >subject</th>
      <th id="T_c08af_level0_col1" class="col_heading level0 col1" >run</th>
      <th id="T_c08af_level0_col2" class="col_heading level0 col2" >image</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td id="T_c08af_row0_col0" class="data row0 col0" >01</td>
      <td id="T_c08af_row0_col1" class="data row0 col1" >1</td>
      <td id="T_c08af_row0_col2" class="data row0 col2" >sub-01_task-simon_run-1_bold.nii.gz</td>
    </tr>
    <tr>
      <td id="T_c08af_row1_col0" class="data row1 col0" >02</td>
      <td id="T_c08af_row1_col1" class="data row1 col1" >1</td>
      <td id="T_c08af_row1_col2" class="data row1 col2" >sub-02_task-simon_run-1_bold.nii.gz</td>
    </tr>
    <tr>
      <td id="T_c08af_row2_col0" class="data row2 col0" >03</td>
      <td id="T_c08af_row2_col1" class="data row2 col1" >1</td>
      <td id="T_c08af_row2_col2" class="data row2 col2" >sub-03_task-simon_run-1_bold.nii.gz</td>
    </tr>
  </tbody>
</table>
</div><div class="output text_html"><style type="text/css">
</style>
<table id="T_f7c4b">
  <thead>
    <tr>
      <th id="T_f7c4b_level0_col0" class="col_heading level0 col0" >subject</th>
      <th id="T_f7c4b_level0_col1" class="col_heading level0 col1" >run</th>
      <th id="T_f7c4b_level0_col2" class="col_heading level0 col2" >image</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td id="T_f7c4b_row0_col0" class="data row0 col0" >01</td>
      <td id="T_f7c4b_row0_col1" class="data row0 col1" >2</td>
      <td id="T_f7c4b_row0_col2" class="data row0 col2" >sub-01_task-simon_run-2_bold.nii.gz</td>
    </tr>
    <tr>
      <td id="T_f7c4b_row1_col0" class="data row1 col0" >02</td>
      <td id="T_f7c4b_row1_col1" class="data row1 col1" >2</td>
      <td id="T_f7c4b_row1_col2" class="data row1 col2" >sub-02_task-simon_run-2_bold.nii.gz</td>
    </tr>
    <tr>
      <td id="T_f7c4b_row2_col0" class="data row2 col0" >03</td>
      <td id="T_f7c4b_row2_col1" class="data row2 col1" >2</td>
      <td id="T_f7c4b_row2_col2" class="data row2 col2" >sub-03_task-simon_run-2_bold.nii.gz</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>However, since we want to model each <code class="docutils literal notranslate"><span class="pre">BOLD</span></code> image separately, we must <code class="docutils literal notranslate"><span class="pre">GroupBy</span></code>
<strong>both <em>subject</em> and <em>run</em></strong>, resulting in six groups with a single image each.</p>
<div class="cell tag_remove_input docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><style type="text/css">
</style>
<table id="T_d3e2d">
  <thead>
    <tr>
      <th id="T_d3e2d_level0_col0" class="col_heading level0 col0" >subject</th>
      <th id="T_d3e2d_level0_col1" class="col_heading level0 col1" >run</th>
      <th id="T_d3e2d_level0_col2" class="col_heading level0 col2" >image</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td id="T_d3e2d_row0_col0" class="data row0 col0" >01</td>
      <td id="T_d3e2d_row0_col1" class="data row0 col1" >1</td>
      <td id="T_d3e2d_row0_col2" class="data row0 col2" >sub-01_task-simon_run-1_bold.nii.gz</td>
    </tr>
  </tbody>
</table>
</div><div class="output text_html"><style type="text/css">
</style>
<table id="T_0e1cf">
  <thead>
    <tr>
      <th id="T_0e1cf_level0_col0" class="col_heading level0 col0" >subject</th>
      <th id="T_0e1cf_level0_col1" class="col_heading level0 col1" >run</th>
      <th id="T_0e1cf_level0_col2" class="col_heading level0 col2" >image</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td id="T_0e1cf_row0_col0" class="data row0 col0" >02</td>
      <td id="T_0e1cf_row0_col1" class="data row0 col1" >1</td>
      <td id="T_0e1cf_row0_col2" class="data row0 col2" >sub-02_task-simon_run-1_bold.nii.gz</td>
    </tr>
  </tbody>
</table>
</div><div class="output text_html"><style type="text/css">
</style>
<table id="T_dcced">
  <thead>
    <tr>
      <th id="T_dcced_level0_col0" class="col_heading level0 col0" >subject</th>
      <th id="T_dcced_level0_col1" class="col_heading level0 col1" >run</th>
      <th id="T_dcced_level0_col2" class="col_heading level0 col2" >image</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td id="T_dcced_row0_col0" class="data row0 col0" >03</td>
      <td id="T_dcced_row0_col1" class="data row0 col1" >1</td>
      <td id="T_dcced_row0_col2" class="data row0 col2" >sub-03_task-simon_run-1_bold.nii.gz</td>
    </tr>
  </tbody>
</table>
</div><div class="output text_html"><style type="text/css">
</style>
<table id="T_6ffad">
  <thead>
    <tr>
      <th id="T_6ffad_level0_col0" class="col_heading level0 col0" >subject</th>
      <th id="T_6ffad_level0_col1" class="col_heading level0 col1" >run</th>
      <th id="T_6ffad_level0_col2" class="col_heading level0 col2" >image</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td id="T_6ffad_row0_col0" class="data row0 col0" >01</td>
      <td id="T_6ffad_row0_col1" class="data row0 col1" >2</td>
      <td id="T_6ffad_row0_col2" class="data row0 col2" >sub-01_task-simon_run-2_bold.nii.gz</td>
    </tr>
  </tbody>
</table>
</div><div class="output text_html"><style type="text/css">
</style>
<table id="T_f9aa4">
  <thead>
    <tr>
      <th id="T_f9aa4_level0_col0" class="col_heading level0 col0" >subject</th>
      <th id="T_f9aa4_level0_col1" class="col_heading level0 col1" >run</th>
      <th id="T_f9aa4_level0_col2" class="col_heading level0 col2" >image</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td id="T_f9aa4_row0_col0" class="data row0 col0" >02</td>
      <td id="T_f9aa4_row0_col1" class="data row0 col1" >2</td>
      <td id="T_f9aa4_row0_col2" class="data row0 col2" >sub-02_task-simon_run-2_bold.nii.gz</td>
    </tr>
  </tbody>
</table>
</div><div class="output text_html"><style type="text/css">
</style>
<table id="T_35e59">
  <thead>
    <tr>
      <th id="T_35e59_level0_col0" class="col_heading level0 col0" >subject</th>
      <th id="T_35e59_level0_col1" class="col_heading level0 col1" >run</th>
      <th id="T_35e59_level0_col2" class="col_heading level0 col2" >image</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td id="T_35e59_row0_col0" class="data row0 col0" >03</td>
      <td id="T_35e59_row0_col1" class="data row0 col1" >2</td>
      <td id="T_35e59_row0_col2" class="data row0 col2" >sub-03_task-simon_run-2_bold.nii.gz</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
</section>
<section id="subject-level-node">
<h3>Subject level Node<a class="headerlink" href="#subject-level-node" title="Permalink to this headline">#</a></h3>
<p>At this point, we have defined a <code class="docutils literal notranslate"><span class="pre">Model</span></code> that will be fit separate to each grouping– in this case a separate time-series model for each <code class="docutils literal notranslate"><span class="pre">run</span></code>.</p>
<p>Next, we want to define a <code class="docutils literal notranslate"><span class="pre">subject</span></code> level node to pool together estimates from this <code class="docutils literal notranslate"><span class="pre">Node</span></code> for each <code class="docutils literal notranslate"><span class="pre">subject</span></code> using a fixed-effects model.</p>
<div class="highlight-JSON notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="nt">&quot;Level&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Subject&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="nt">&quot;Name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;subject_level&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="nt">&quot;GroupBy&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;subject&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;contrast&quot;</span><span class="p">],</span><span class="w"></span>
<span class="w">      </span><span class="nt">&quot;Model&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;X&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="nt">&quot;Type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;meta&quot;</span><span class="p">},</span><span class="w"></span>
<span class="w">      </span><span class="nt">&quot;DummyContrasts&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;Test&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;t&quot;</span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">},</span><span class="w"></span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>By default, <code class="docutils literal notranslate"><span class="pre">Nodes</span></code> are linked in sequential order, with all the <code class="docutils literal notranslate"><span class="pre">Contrast</span></code> outputs from a <code class="docutils literal notranslate"><span class="pre">Node</span></code> available to the subsequent <code class="docutils literal notranslate"><span class="pre">Node</span></code>.</p>
</div>
<section id="from-run-outputs-to-subject-inputs">
<h4>From Run Outputs to Subject Inputs<a class="headerlink" href="#from-run-outputs-to-subject-inputs" title="Permalink to this headline">#</a></h4>
<p>We need to use <code class="docutils literal notranslate"><span class="pre">GroupBy</span></code> to define how to group the outputs from the <code class="docutils literal notranslate"><span class="pre">Run</span></code> node
as inputs to the <code class="docutils literal notranslate"><span class="pre">Subject</span></code> level:</p>
<div class="highlight-JSON notranslate"><div class="highlight"><pre><span></span><span class="w">      </span><span class="nt">&quot;GroupBy&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;subject&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;contrast&quot;</span><span class="p">],</span><span class="w"></span>
</pre></div>
</div>
<p>Here we are specifying that all images belonging to a single <code class="docutils literal notranslate"><span class="pre">subject</span></code> and from a single <code class="docutils literal notranslate"><span class="pre">contrast</span></code> should be grouped into a unit of analysis.</p>
<p>Note that with 3 subjects and 2 runs, we will have 6 groups of output images from the <code class="docutils literal notranslate"><span class="pre">Run</span></code> node. Given two types of images (<code class="docutils literal notranslate"><span class="pre">variance</span></code> and <code class="docutils literal notranslate"><span class="pre">effect</span></code>), this results in 12 images that would be grouped as follows:</p>
<div class="cell tag_remove_input docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><style type="text/css">
</style>
<table id="T_d574b">
  <thead>
    <tr>
      <th id="T_d574b_level0_col0" class="col_heading level0 col0" >subject</th>
      <th id="T_d574b_level0_col1" class="col_heading level0 col1" >run</th>
      <th id="T_d574b_level0_col2" class="col_heading level0 col2" >contrast</th>
      <th id="T_d574b_level0_col3" class="col_heading level0 col3" >image</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td id="T_d574b_row0_col0" class="data row0 col0" >01</td>
      <td id="T_d574b_row0_col1" class="data row0 col1" >1</td>
      <td id="T_d574b_row0_col2" class="data row0 col2" >IvC</td>
      <td id="T_d574b_row0_col3" class="data row0 col3" >sub-01_task-simon_run-1_contrast-IvC_stat-effect_statmap.nii</td>
    </tr>
    <tr>
      <td id="T_d574b_row1_col0" class="data row1 col0" >01</td>
      <td id="T_d574b_row1_col1" class="data row1 col1" >1</td>
      <td id="T_d574b_row1_col2" class="data row1 col2" >IvC</td>
      <td id="T_d574b_row1_col3" class="data row1 col3" >sub-01_task-simon_run-1_contrast-IvC_stat-variance_statmap.nii</td>
    </tr>
    <tr>
      <td id="T_d574b_row2_col0" class="data row2 col0" >01</td>
      <td id="T_d574b_row2_col1" class="data row2 col1" >2</td>
      <td id="T_d574b_row2_col2" class="data row2 col2" >IvC</td>
      <td id="T_d574b_row2_col3" class="data row2 col3" >sub-01_task-simon_run-2_contrast-IvC_stat-effect_statmap.nii</td>
    </tr>
    <tr>
      <td id="T_d574b_row3_col0" class="data row3 col0" >01</td>
      <td id="T_d574b_row3_col1" class="data row3 col1" >2</td>
      <td id="T_d574b_row3_col2" class="data row3 col2" >IvC</td>
      <td id="T_d574b_row3_col3" class="data row3 col3" >sub-01_task-simon_run-2_contrast-IvC_stat-variance_statmap.nii</td>
    </tr>
  </tbody>
</table>
</div><div class="output text_html"><style type="text/css">
</style>
<table id="T_79f2c">
  <thead>
    <tr>
      <th id="T_79f2c_level0_col0" class="col_heading level0 col0" >subject</th>
      <th id="T_79f2c_level0_col1" class="col_heading level0 col1" >run</th>
      <th id="T_79f2c_level0_col2" class="col_heading level0 col2" >contrast</th>
      <th id="T_79f2c_level0_col3" class="col_heading level0 col3" >image</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td id="T_79f2c_row0_col0" class="data row0 col0" >02</td>
      <td id="T_79f2c_row0_col1" class="data row0 col1" >1</td>
      <td id="T_79f2c_row0_col2" class="data row0 col2" >IvC</td>
      <td id="T_79f2c_row0_col3" class="data row0 col3" >sub-02_task-simon_run-1_contrast-IvC_stat-effect_statmap.nii</td>
    </tr>
    <tr>
      <td id="T_79f2c_row1_col0" class="data row1 col0" >02</td>
      <td id="T_79f2c_row1_col1" class="data row1 col1" >1</td>
      <td id="T_79f2c_row1_col2" class="data row1 col2" >IvC</td>
      <td id="T_79f2c_row1_col3" class="data row1 col3" >sub-02_task-simon_run-1_contrast-IvC_stat-variance_statmap.nii</td>
    </tr>
    <tr>
      <td id="T_79f2c_row2_col0" class="data row2 col0" >02</td>
      <td id="T_79f2c_row2_col1" class="data row2 col1" >2</td>
      <td id="T_79f2c_row2_col2" class="data row2 col2" >IvC</td>
      <td id="T_79f2c_row2_col3" class="data row2 col3" >sub-02_task-simon_run-2_contrast-IvC_stat-effect_statmap.nii</td>
    </tr>
    <tr>
      <td id="T_79f2c_row3_col0" class="data row3 col0" >02</td>
      <td id="T_79f2c_row3_col1" class="data row3 col1" >2</td>
      <td id="T_79f2c_row3_col2" class="data row3 col2" >IvC</td>
      <td id="T_79f2c_row3_col3" class="data row3 col3" >sub-02_task-simon_run-2_contrast-IvC_stat-variance_statmap.nii</td>
    </tr>
  </tbody>
</table>
</div><div class="output text_html"><style type="text/css">
</style>
<table id="T_d2905">
  <thead>
    <tr>
      <th id="T_d2905_level0_col0" class="col_heading level0 col0" >subject</th>
      <th id="T_d2905_level0_col1" class="col_heading level0 col1" >run</th>
      <th id="T_d2905_level0_col2" class="col_heading level0 col2" >contrast</th>
      <th id="T_d2905_level0_col3" class="col_heading level0 col3" >image</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td id="T_d2905_row0_col0" class="data row0 col0" >03</td>
      <td id="T_d2905_row0_col1" class="data row0 col1" >1</td>
      <td id="T_d2905_row0_col2" class="data row0 col2" >IvC</td>
      <td id="T_d2905_row0_col3" class="data row0 col3" >sub-03_task-simon_run-1_contrast-IvC_stat-effect_statmap.nii</td>
    </tr>
    <tr>
      <td id="T_d2905_row1_col0" class="data row1 col0" >03</td>
      <td id="T_d2905_row1_col1" class="data row1 col1" >1</td>
      <td id="T_d2905_row1_col2" class="data row1 col2" >IvC</td>
      <td id="T_d2905_row1_col3" class="data row1 col3" >sub-03_task-simon_run-1_contrast-IvC_stat-variance_statmap.nii</td>
    </tr>
    <tr>
      <td id="T_d2905_row2_col0" class="data row2 col0" >03</td>
      <td id="T_d2905_row2_col1" class="data row2 col1" >2</td>
      <td id="T_d2905_row2_col2" class="data row2 col2" >IvC</td>
      <td id="T_d2905_row2_col3" class="data row2 col3" >sub-03_task-simon_run-2_contrast-IvC_stat-effect_statmap.nii</td>
    </tr>
    <tr>
      <td id="T_d2905_row3_col0" class="data row3 col0" >03</td>
      <td id="T_d2905_row3_col1" class="data row3 col1" >2</td>
      <td id="T_d2905_row3_col2" class="data row3 col2" >IvC</td>
      <td id="T_d2905_row3_col3" class="data row3 col3" >sub-03_task-simon_run-2_contrast-IvC_stat-variance_statmap.nii</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Although there is only one <code class="docutils literal notranslate"><span class="pre">contrast</span></code>, we include <code class="docutils literal notranslate"><span class="pre">contrast</span></code> as a grouping variable to be explicit.</p>
</div>
</section>
<section id="subject-model">
<h4>Subject Model<a class="headerlink" href="#subject-model" title="Permalink to this headline">#</a></h4>
<p>We can now specify the <code class="docutils literal notranslate"><span class="pre">Subject</span></code> level <code class="docutils literal notranslate"><span class="pre">Model</span></code>.</p>
<div class="highlight-JSON notranslate"><div class="highlight"><pre><span></span><span class="w">      </span><span class="nt">&quot;Model&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;X&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="nt">&quot;Type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;meta&quot;</span><span class="p">},</span><span class="w"></span>
<span class="w">      </span><span class="nt">&quot;DummyContrasts&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;Test&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;t&quot;</span><span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p>Since our intent is to estimate the <em>mean effect</em> for each subject, we only need an
intercept in our model. We specify the <code class="docutils literal notranslate"><span class="pre">&quot;Type&quot;</span></code> to be <code class="docutils literal notranslate"><span class="pre">Meta</span></code>, which is a
special type to identify fixed-effects models.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">1</span></code> is a special variable used to represent the intercept.</p>
</div>
<p>Remember that we must specify <code class="docutils literal notranslate"><span class="pre">Contrasts</span></code> in order to produce outputs for the
next <code class="docutils literal notranslate"><span class="pre">Node</span></code>. <code class="docutils literal notranslate"><span class="pre">DummyContrasts</span></code> is a convenience function which will create contrasts with
the weights <code class="docutils literal notranslate"><span class="pre">[1]</span></code> for all modeled inputs. Since we are not comparing anything at
the subject-level and simply want to pass forward the estimates generated by the
fixed-effects model, this is useful and saves us from specifying a more
verbose (but identical) <code class="docutils literal notranslate"><span class="pre">Contrast</span></code>.</p>
</section>
</section>
<section id="dataset-level-node">
<h3>Dataset level Node<a class="headerlink" href="#dataset-level-node" title="Permalink to this headline">#</a></h3>
<p>We are ready to perform a one-sample t-test to estimate population-level effects
for the <em>IvC</em> <code class="docutils literal notranslate"><span class="pre">Contrast</span></code>. We refer to this level as the <code class="docutils literal notranslate"><span class="pre">Dataset</span></code> level.</p>
<div class="highlight-JSON notranslate"><div class="highlight"><pre><span></span><span class="w">      </span><span class="nt">&quot;Level&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Dataset&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="nt">&quot;Name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;one-sample_dataset&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="nt">&quot;GroupBy&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;contrast&quot;</span><span class="p">],</span><span class="w"></span>
</pre></div>
</div>
<p>Here we only need to <code class="docutils literal notranslate"><span class="pre">GroupBy:</span> <span class="pre">['contrast']</span></code> as we want to compute a separate estimate for
each contrast, but want to include all subjects in the same analysis.</p>
<p>Since we only have one <code class="docutils literal notranslate"><span class="pre">contrast</span></code>, all the incoming subject-level images will be grouped
together:</p>
<div class="cell tag_remove_input docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><style type="text/css">
</style>
<table id="T_2e1a6">
  <thead>
    <tr>
      <th id="T_2e1a6_level0_col0" class="col_heading level0 col0" >subject</th>
      <th id="T_2e1a6_level0_col1" class="col_heading level0 col1" >contrast</th>
      <th id="T_2e1a6_level0_col2" class="col_heading level0 col2" >image</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td id="T_2e1a6_row0_col0" class="data row0 col0" >01</td>
      <td id="T_2e1a6_row0_col1" class="data row0 col1" >IvC</td>
      <td id="T_2e1a6_row0_col2" class="data row0 col2" >sub-01_task-simon_contrast-IvC_stat-effect_statmap.nii</td>
    </tr>
    <tr>
      <td id="T_2e1a6_row1_col0" class="data row1 col0" >01</td>
      <td id="T_2e1a6_row1_col1" class="data row1 col1" >IvC</td>
      <td id="T_2e1a6_row1_col2" class="data row1 col2" >sub-01_task-simon_contrast-IvC_stat-variance_statmap.nii</td>
    </tr>
    <tr>
      <td id="T_2e1a6_row2_col0" class="data row2 col0" >02</td>
      <td id="T_2e1a6_row2_col1" class="data row2 col1" >IvC</td>
      <td id="T_2e1a6_row2_col2" class="data row2 col2" >sub-02_task-simon_contrast-IvC_stat-effect_statmap.nii</td>
    </tr>
    <tr>
      <td id="T_2e1a6_row3_col0" class="data row3 col0" >02</td>
      <td id="T_2e1a6_row3_col1" class="data row3 col1" >IvC</td>
      <td id="T_2e1a6_row3_col2" class="data row3 col2" >sub-02_task-simon_contrast-IvC_stat-variance_statmap.nii</td>
    </tr>
    <tr>
      <td id="T_2e1a6_row4_col0" class="data row4 col0" >03</td>
      <td id="T_2e1a6_row4_col1" class="data row4 col1" >IvC</td>
      <td id="T_2e1a6_row4_col2" class="data row4 col2" >sub-03_task-simon_contrast-IvC_stat-effect_statmap.nii</td>
    </tr>
    <tr>
      <td id="T_2e1a6_row5_col0" class="data row5 col0" >03</td>
      <td id="T_2e1a6_row5_col1" class="data row5 col1" >IvC</td>
      <td id="T_2e1a6_row5_col2" class="data row5 col2" >sub-03_task-simon_contrast-IvC_stat-variance_statmap.nii</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>As before, we can specify an intercept-only model, but of type <code class="docutils literal notranslate"><span class="pre">glm</span></code> since we want to perform a random-effects analysis. We can again use <code class="docutils literal notranslate"><span class="pre">DummyContrasts</span></code> to specify a simple one-sample t-test contrast on the incoming <code class="docutils literal notranslate"><span class="pre">IvC</span></code> subject-level contrasts.</p>
<div class="highlight-JSON notranslate"><div class="highlight"><pre><span></span><span class="w">      </span><span class="nt">&quot;Model&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;X&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="nt">&quot;Type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;glm&quot;</span><span class="p">},</span><span class="w"></span>
<span class="w">      </span><span class="nt">&quot;DummyContrasts&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;Test&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;t&quot;</span><span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p>The outputs of this node collapse across subjects, leaving a single effect/variance pair:</p>
<div class="cell tag_remove_input docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><style type="text/css">
</style>
<table id="T_ec487">
  <thead>
    <tr>
      <th id="T_ec487_level0_col0" class="col_heading level0 col0" >contrast</th>
      <th id="T_ec487_level0_col1" class="col_heading level0 col1" >image</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td id="T_ec487_row0_col0" class="data row0 col0" >IvC</td>
      <td id="T_ec487_row0_col1" class="data row0 col1" >task-simon_contrast-IvC_stat-effect_statmap.nii</td>
    </tr>
    <tr>
      <td id="T_ec487_row1_col0" class="data row1 col0" >IvC</td>
      <td id="T_ec487_row1_col1" class="data row1 col1" >task-simon_contrast-IvC_stat-variance_statmap.nii</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
</section>
<section id="ready-to-run">
<h2>Ready to run 🚀<a class="headerlink" href="#ready-to-run" title="Permalink to this headline">#</a></h2>
<p>At this point, we have a fully specified model three-stage fMRI model.</p>
<p>Our model will compute a run level incongruent-congruent contrast, pass forward the estimates to a fixed-effects model to pool subject estimates, and compute a dataset-level random-effects model and one-sample t-test to estimate population effects for the <code class="docutils literal notranslate"><span class="pre">IvC</span></code> contrast.</p>
<p>We can now pair this <em>BSM</em> specification with a pre-processed derivative from the original raw dataset and hand these to a tool that supports <em>BSM</em> for <strong>fully automated execution</strong>.</p>
</section>
<section id="next-up">
<h2>Next up<a class="headerlink" href="#next-up" title="Permalink to this headline">#</a></h2>
<ul class="simple">
<li><p>Read the next section to dive deeper into advanced usage of <em>BSM</em> to enable more complex models.</p></li>
<li><p>Check out tools like <a class="reference external" href="https://github.com/poldracklab/fitlins">FitLins</a> which implement <em>BSM</em> execution to learn how to run a <em>BIDS Stats Model</em></p></li>
<li><p>Take a look at more example models in the  <strong><a class="reference internal" href="model-zoo.html"><span class="doc std std-doc">Model Zoo</span></a></strong>.</p></li>
</ul>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="walkthrough-intro.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Walkthrough</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="walkthrough-2.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Advanced usage</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By The BIDS Community<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>